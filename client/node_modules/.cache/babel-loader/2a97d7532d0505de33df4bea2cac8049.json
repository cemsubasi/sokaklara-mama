{"ast":null,"code":"var _jsxFileName = \"/home/cem/projects/streets/client/src/components/map/Map.js\",\n    _s = $RefreshSig$();\n\nimport { Loader } from \"@googlemaps/js-api-loader\";\nimport { useEffect, useRef, useState } from \"react\";\nimport { connect } from \"react-redux\";\nimport { axi } from \"../../utils/config\";\nimport { addFoodCircle, addWaterCircle } from \"./circle\";\nimport addMarker from \"./marker\";\nimport icongray from \"../../images/button-gray.png\";\nimport styles from \"./home.module.css\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction Map(props) {\n  _s();\n\n  const [loading, setLoading] = useState(false);\n  const mapElement = useRef(null);\n  const centerElement = useRef(null);\n  const map = useRef({});\n  const markerRef = useRef(null); // const defaultStyle = { width: \"100vw\", height: \"100vh\" };\n\n  console.log(\"cityList\", props.cityList);\n  useEffect(() => {\n    const loader = new Loader({\n      apiKey: props.apiKey || \"AIzaSyDit4G0bMDP54KRwVqRTzvFtFGMNPRt_mo\",\n      version: \"weekly\",\n      libraries: [\"places\"]\n    });\n    if (!props.initLocation || props.initLocation.lat === 0) return;\n    loader.load().then(() => {\n      map.current = new window.google.maps.Map(mapElement.current, {\n        zoom: 16,\n        center: props.initLocation,\n        scaleControl: false,\n        streetViewControl: false,\n        rotateControl: false,\n        mapTypeControl: false\n      });\n      map.current.controls[window.google.maps.ControlPosition.RIGHT_BOTTOM].push(centerElement.current);\n      addMarker(markerRef, props.initLocation, map.current);\n      addFoodCircle(map.current, props.cityList, props.user);\n      addWaterCircle(map.current, props.cityList, props.user);\n      setLoading(true);\n    }).catch(console.log).then(() => {\n      axi(\"get\", \"/food\").then(res1 => {\n        props.setCityList({ ...props.cityList,\n          food: [...props.cityList.food, ...res1.response]\n        });\n      }).catch(console.log);\n    }).catch(console.log); // .then(() => {\n    // \taxi(\"get\", \"/water\")\n    // \t\t.then((res2) => {\n    // \t\t\tprops.setCityList({\n    // \t\t\t\t...props.cityList,\n    // \t\t\t\twater: [...props.cityList.water, ...res2.response],\n    // \t\t\t});\n    // \t\t})\n    // \t\t.catch(console.log);\n    // })\n    // .catch(console.log);\n  }, //eslint-disable-next-line\n  [props.initLocation]);\n  useEffect(() => {\n    if (map.current.setCenter) {\n      addFoodCircle(map.current, props.cityList, props.user);\n      addWaterCircle(map.current, props.cityList, props.user);\n    }\n  }, //eslint-disable-next-line\n  [props.cityList]);\n  useEffect(() => {\n    if (markerRef.current) {\n      markerRef.current.setMap(null);\n      addMarker(markerRef, props.locationState, map.current);\n    }\n  }, [props.locationState]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: styles.map,\n    ref: mapElement,\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      ref: centerElement,\n      style: {\n        backgroundColor: \"#fff\",\n        border: \"2px solid #fff\",\n        borderRadius: \"3px\",\n        boxShadow: \"0 2px 6px rgba(0,0,0,.3)\",\n        cursor: \"pointer\",\n        marginBottom: \"22px\",\n        textAlign: \"center\",\n        marginRight: \"10px\",\n        top: \"null\",\n        display: loading ? \"block\" : \"none\"\n      },\n      onClick: () => {\n        map.current.setCenter(props.locationState);\n      },\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          color: \"rgb(25,25,25)\",\n          fontFamily: \"Roboto,Arial,sans-serif\",\n          fontSize: \"24px\",\n          lineHeight: \"36px\",\n          paddingLeft: \"9px\",\n          paddingRight: \"9px\"\n        },\n        children: /*#__PURE__*/_jsxDEV(\"img\", {\n          src: icongray,\n          alt: \"\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 124,\n          columnNumber: 6\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 114,\n        columnNumber: 5\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 4\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 95,\n    columnNumber: 3\n  }, this);\n}\n\n_s(Map, \"EJQ4taeTfWwiRGTCwwd306UoV0s=\");\n\n_c = Map;\n\nconst mapStateToProps = state => {\n  return {\n    user: state.user\n  };\n};\n\nexport default connect(mapStateToProps)(Map);\n\nvar _c;\n\n$RefreshReg$(_c, \"Map\");","map":{"version":3,"sources":["/home/cem/projects/streets/client/src/components/map/Map.js"],"names":["Loader","useEffect","useRef","useState","connect","axi","addFoodCircle","addWaterCircle","addMarker","icongray","styles","Map","props","loading","setLoading","mapElement","centerElement","map","markerRef","console","log","cityList","loader","apiKey","version","libraries","initLocation","lat","load","then","current","window","google","maps","zoom","center","scaleControl","streetViewControl","rotateControl","mapTypeControl","controls","ControlPosition","RIGHT_BOTTOM","push","user","catch","res1","setCityList","food","response","setCenter","setMap","locationState","backgroundColor","border","borderRadius","boxShadow","cursor","marginBottom","textAlign","marginRight","top","display","color","fontFamily","fontSize","lineHeight","paddingLeft","paddingRight","mapStateToProps","state"],"mappings":"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","sourcesContent":["import { Loader } from \"@googlemaps/js-api-loader\";\nimport { useEffect, useRef, useState } from \"react\";\nimport { connect } from \"react-redux\";\n\nimport { axi } from \"../../utils/config\";\nimport { addFoodCircle, addWaterCircle } from \"./circle\";\nimport addMarker from \"./marker\";\nimport icongray from \"../../images/button-gray.png\";\nimport styles from \"./home.module.css\";\n\nfunction Map(props) {\n\tconst [loading, setLoading] = useState(false);\n\tconst mapElement = useRef(null);\n\tconst centerElement = useRef(null);\n\tconst map = useRef({});\n\tconst markerRef = useRef(null);\n\t// const defaultStyle = { width: \"100vw\", height: \"100vh\" };\n\tconsole.log(\"cityList\", props.cityList);\n\n\tuseEffect(\n\t\t() => {\n\t\t\tconst loader = new Loader({\n\t\t\t\tapiKey: props.apiKey || \"AIzaSyDit4G0bMDP54KRwVqRTzvFtFGMNPRt_mo\",\n\t\t\t\tversion: \"weekly\",\n\t\t\t\tlibraries: [\"places\"],\n\t\t\t});\n\n\t\t\tif (!props.initLocation || props.initLocation.lat === 0) return;\n\n\t\t\tloader\n\t\t\t\t.load()\n\t\t\t\t.then(() => {\n\t\t\t\t\tmap.current = new window.google.maps.Map(mapElement.current, {\n\t\t\t\t\t\tzoom: 16,\n\t\t\t\t\t\tcenter: props.initLocation,\n\t\t\t\t\t\tscaleControl: false,\n\t\t\t\t\t\tstreetViewControl: false,\n\t\t\t\t\t\trotateControl: false,\n\t\t\t\t\t\tmapTypeControl: false,\n\t\t\t\t\t});\n\t\t\t\t\tmap.current.controls[\n\t\t\t\t\t\twindow.google.maps.ControlPosition.RIGHT_BOTTOM\n\t\t\t\t\t].push(centerElement.current);\n\t\t\t\t\taddMarker(markerRef, props.initLocation, map.current);\n\t\t\t\t\taddFoodCircle(map.current, props.cityList, props.user);\n\t\t\t\t\taddWaterCircle(map.current, props.cityList, props.user);\n\t\t\t\t\tsetLoading(true);\n\t\t\t\t})\n\t\t\t\t.catch(console.log)\n\t\t\t\t.then(() => {\n\t\t\t\t\taxi(\"get\", \"/food\")\n\t\t\t\t\t\t.then((res1) => {\n\t\t\t\t\t\t\tprops.setCityList({\n\t\t\t\t\t\t\t\t...props.cityList,\n\t\t\t\t\t\t\t\tfood: [...props.cityList.food, ...res1.response],\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.catch(console.log);\n\t\t\t\t})\n\t\t\t\t.catch(console.log)\n\t\t\t\t// .then(() => {\n\t\t\t\t// \taxi(\"get\", \"/water\")\n\t\t\t\t// \t\t.then((res2) => {\n\t\t\t\t// \t\t\tprops.setCityList({\n\t\t\t\t// \t\t\t\t...props.cityList,\n\t\t\t\t// \t\t\t\twater: [...props.cityList.water, ...res2.response],\n\t\t\t\t// \t\t\t});\n\t\t\t\t// \t\t})\n\t\t\t\t// \t\t.catch(console.log);\n\t\t\t\t// })\n\t\t\t\t// .catch(console.log);\n\t\t},\n\t\t//eslint-disable-next-line\n\t\t[props.initLocation]\n\t);\n\n\tuseEffect(\n\t\t() => {\n\t\t\tif (map.current.setCenter) {\n\t\t\t\taddFoodCircle(map.current, props.cityList, props.user);\n\t\t\t\taddWaterCircle(map.current, props.cityList, props.user);\n\t\t\t}\n\t\t},\n\t\t//eslint-disable-next-line\n\t\t[props.cityList]\n\t);\n\n\tuseEffect(() => {\n\t\tif (markerRef.current) {\n\t\t\tmarkerRef.current.setMap(null);\n\t\t\taddMarker(markerRef, props.locationState, map.current);\n\t\t}\n\t}, [props.locationState]);\n\treturn (\n\t\t<div className={styles.map} ref={mapElement}>\n\t\t\t<div\n\t\t\t\tref={centerElement}\n\t\t\t\tstyle={{\n\t\t\t\t\tbackgroundColor: \"#fff\",\n\t\t\t\t\tborder: \"2px solid #fff\",\n\t\t\t\t\tborderRadius: \"3px\",\n\t\t\t\t\tboxShadow: \"0 2px 6px rgba(0,0,0,.3)\",\n\t\t\t\t\tcursor: \"pointer\",\n\t\t\t\t\tmarginBottom: \"22px\",\n\t\t\t\t\ttextAlign: \"center\",\n\t\t\t\t\tmarginRight: \"10px\",\n\t\t\t\t\ttop: \"null\",\n\t\t\t\t\tdisplay: loading ? \"block\" : \"none\",\n\t\t\t\t}}\n\t\t\t\tonClick={() => {\n\t\t\t\t\tmap.current.setCenter(props.locationState);\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<div\n\t\t\t\t\tstyle={{\n\t\t\t\t\t\tcolor: \"rgb(25,25,25)\",\n\t\t\t\t\t\tfontFamily: \"Roboto,Arial,sans-serif\",\n\t\t\t\t\t\tfontSize: \"24px\",\n\t\t\t\t\t\tlineHeight: \"36px\",\n\t\t\t\t\t\tpaddingLeft: \"9px\",\n\t\t\t\t\t\tpaddingRight: \"9px\",\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t<img src={icongray} alt=\"\" />\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t);\n}\n\nconst mapStateToProps = (state) => {\n\treturn {\n\t\tuser: state.user,\n\t};\n};\n\nexport default connect(mapStateToProps)(Map);\n"]},"metadata":{},"sourceType":"module"}